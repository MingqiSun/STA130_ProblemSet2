---
title: "STA130H1S -- Fall 2022"
author: "<Student Name> (<Student Number>) and STA130 Professors"
subtitle: Problem Set 2
urlcolor: blue
output:
  pdf_document: default
---

```{r, include=FALSE}
knitr::opts_chunk$set(eval=TRUE, include=TRUE, echo=TRUE, message=TRUE, warning=FALSE)
```

# Instructions

Complete the exercises in this .Rmd file and submit your .Rmd and .pdf output through [Quercus](https://q.utoronto.ca/courses/277998/assignments/910603) on September 22 by 5:00 p.m. ET. 

## Question 1

The Week 1 Problem Set included the following code.

```{r, eval=FALSE, echo=TRUE}
my_answers <- c(r1,r2,c1,c2)
square_answers <- c(10,-1,3,12)
```

For the first three questions below choose the correct answer from the following.

(A) A single value counting how many correct rows and columns you calculated.
(B) A numeric vector of the differences between the math square answers and your answers (should be all 0s if you got them all right).
(C) A character vector of 'TRUE' and 'FALSE', 'TRUE' for each answer that matches and 'FALSE' for any that don't.
(D) A logical vector of `TRUE` and `FALSE`, `TRUE` for each answer that matches and `FALSE` for any that don't.
(E) A single logical value `TRUE` or `FALSE`, `TRUE` if all the values match, `FALSE` if any of the values don't match.


### a) Which of the above best describes what `my_answers == square_answers` is?

*(D)*

### b) Which of the above best describes what `sum(my_answers == square_answers)` is?

*(A)*

### c) Which of the above best describes what `all(my_answers == square_answers)` is?

*(E)*

### d) What is the sequence of steps involved in getting the answer for `sum(c(TRUE,FALSE))`? What additional step is required to get the answer for `sum(my_answers == square_answers)`?

*The `TRUE` and `FALSE` `logical` values are turned into the numbers $1$ and $0$, respectively, automatically, through the processes known as coercion. Then the numbers are summed. The second code statement is similar, except before the "coercion" and "summing", the vectors `my_answers` and `square_answers` are compared in an elementwise manner, and entries which match are given `TRUE` `logical` values while those that don't are given `FALSE` `logical` values.*

#### Hints
- Your answer should include the word ***coercion***.
- The `sum` function works only on `numeric` data types and does not itself directly know anything about `logical` data types.

## Question 2

The data for this question will be based on a sample of Superbowl ads.

- The data is stored in the file `superbowl_ads.csv` in the same directory as this file,
and includes the following variables:

  - `year` (double) Superbowl year
  - `brand`	(character)	Brand for commercial
  - `funny`	(logical)	Contains humor
  - `show_product_quickly`	(logical))	Shows product quickly
  - `celebrity`	(logical) Contains celebrity
  - `danger`	(logical)	Contains danger
  - `view_count`	(double)	Youtube view count
  - `like_count`	(double)	Youtube like count
  - `dislike_count`	(double)	Youtube dislike count
  - `superbowl_ads_dot_com_url`	(character)	Superbowl ad URL
 
> This data was posted on [github](https://github.com/fivethirtyeight/superbowl-ads#super-bowl-ads) by the data-oriented reporting outlet [FiveThirtyEight](https://github.com/fivethirtyeight) and subsequently featured on [Tidy Tuesday](https://github.com/rfordatascience/tidytuesday/blob/master/data/2021/2021-03-02/readme.md).  For more information see the above links.

```{r, message=FALSE}
library(tidyverse) # Load the tidyverse functionality so it is available to use 
superbowl <- read_csv("superbowl_ads.csv")
```

### (a) Use the `glimpse()` function to view properties of the `superbowl` data set. How many rows and columns are there? How many observations does it include? How many variables are measured for each observation? 

```{r}
superbowl %>% glimpse()
```

*There are 211 rows/observations, and 11 columns/variables.*

### (b) Create 3 histograms to explore the distribution of `view_count`: (i) one with 2 bins, (ii) one with 8 bins, and (iii) one with 50 bins; make sure to specify meaningful axis labels where appropriate. Which of these histograms is most appropriate to describe the distribution of `view_count`? Why? Write a few sentences describing the distribution based on the histogram you chose as most appropriate.

```{r}
# You can put multiple plots in the same code chunk

hist1 <- ggplot(data=superbowl, aes(x=view_count)) + 
  geom_histogram(color="black", fill="gray", bins=2) + 
  labs(x="Number of youtube likes")

hist2 <- ggplot(data=superbowl, aes(x=view_count)) + 
  geom_histogram(color="black", fill="gray", bins=8) + 
  labs(x="Number of youtube likes")

hist3 <- ggplot(data=superbowl, aes(x=view_count)) + 
  geom_histogram(color="black", fill="gray", bins=50) + 
  labs(x="Number of youtube likes")


# the gridExtra package allows for plots to be 
# arranged in a grid layout - we'll load it here
# you are NOT REQUIRED to know or use this function
# we're just showing you how we set things up
library(gridExtra)
grid.arrange(hist1, hist2, hist3, nrow=1, ncol=3)
```

```{r}
# Or your can put different plots in separate code chunks
hist2
```

```{r}
# Feel free to add or remove code chunks as desired
hist3
```


Among these three histograms, the one with 8 bins is best suited to describe the overall distribution of the average number of players at the same time, as it best allows us to describe the center, shape, and spread.  

* __Shape__: The number of views of superbowl ads is right skewed and unimodal.

* __Spread__: Based on histogram 2 we can say that number of views seems to be between 0 and 1 million

* __Centre__: The mean is larger than the median. The median number of views is likely around ~150,000 and the mean average number views is something larger.



### (c) Construct two plots to visualize the distribution of `brand` and one of these other categorical variables:  `funny`, `danger` or `celebrity` from the superbowl ads data and describe the distribution in 1-2 sentences; make sure to specify meaningful axis labels where appropriate. Hint: If you choose a categorical variable with many different categories, you may find it useful to use `coord_flip()` to flip the bars horizontally and/or change the options in the R code chunk to make the plot large (ex: {r, fig.height=15, fig.width=5}).

```{r, message=FALSE, fig.height=3, fig.width=4, fig.align='center'}
# One reason to use use different code chunks for different figures is
# to assign different figure aspect ratio controls to different figure
ggplot(data=superbowl, aes(x=brand)) + 
  geom_bar() + 
  labs(x="Brand") 

ggplot(data=superbowl, aes(x=funny)) + 
  geom_bar() + 
  labs(x="Funny") 
```

*The most popular brand is BudLight, with about 60 ads, followed by Budweiser and Pepsi. The least common brand is NFL. Other brands are not as common include Coca-Cola, Doritos, Kia and Toyota, all of which have below 20 ads. There are more "Funny" superbowl ads (~150) than not Funny superbowl ads (~70) within this dataset.*

### (d) Construct a set of two boxplots showing visual summaries of the distribution of number of likes (`like_count`) for whether ads included a celebrity or not (`celebrity`); make sure to specify meaningful axis labels where appropriate. Write 3-4 sentences comparing these distributions.

```{r}
# This should be a single plot, NOT TWO... boxplots can be put in the same plot!
superbowl %>% ggplot(aes(x=celebrity, y=like_count)) + geom_boxplot() + 
  labs(x="Ad included celebrity", y="Number of likes")
```

*The distribution for the number of likes when an ad includes a celebrity appear to be right skewed. The distribution for the number of likes when an ad does not include a celebrity appears to also be right skewed, but with smaller center and spread. In this case the median and third quartile of number of likes is higher for ads which include a celebrity. The IQR and range of number of likes is also higher for ads which include a celebrity.*

## Question 3

The `births` data set is part of the `openintro` package. It consists of random sample of 100 births for babies in North Carolina where the mother was not a smoker and another 50 where the mother was a smoker.   Type `?births` in the R console for more information about the data and to see the definition of each variable. The code below loads the required libraries for this question and provides a glimpse of the `births` data frame.

```{r, echo=FALSE}
library(tidyverse)
library(openintro)
```

```{r}
births %>% glimpse()
```
  
### (a) Choose two categorical variables and plot the distribution of each one (in seperate plots). Identify whether each of these variables is a nominal or ordinal categorical variable. Write one or two sentences interpreting each plot.  

```{r, message=FALSE, fig.height=3, fig.width=4, fig.align='center'}
ggplot(data = births) + aes(x = sex_baby) + 
  geom_bar() + labs(x="Sex of the Baby")
ggplot(data = births) + aes(x = premature) + 
  geom_bar() + coord_flip() + 
  labs(x="Whether Baby was born premature")
```

*The first plot shows that there are approximately the same number of male and female babies (`r sum(ncbirths$gender=="male")` vs `r sum(ncbirths$gender=="female")`).  Sex of the baby is a nominal categorical variable. The second plot shows that the majority of babies were born at full-term (i.e., not prematurely). This is a nominal categorical variable.*

### (b) Choose a quantitative variable and plot its distribution.  Identify whether the variable you selected is continuous or discrete, and write 2-3 sentences describing the distribution.

```{r, message=FALSE, fig.width=3, fig.height=4, fig.align='center'}
ggplot(data = births) + aes(x = weight) + 
  geom_histogram(fill = "grey", colour = "black", bins=25) + xlim(0,12) +
  labs(x="Weight (in pounds)")
```

*The variable I chose is babies' birth weight, and this is a continuous numerical variable. The distribution of babies' birth weight is left skewed since the left tail is longer than the right tail. There is one prominent peak so the distribution is unimodal, with a mode around 7.5 pounds. Values of birth weight range from approximately 1 pound to over 12 pounds.*

### (c) Construct a plot that shows the relationship between birth weight (`weight`) and mother's smoking status (`smoke`); make sure to specify meaningful axis labels where appropriate.  

```{r, message=FALSE, fig.width=3, fig.height=4, fig.align='center'}
# To figure out how to do this google "ggplot2 scatter plot", or check out 
# - https://ggplot2.tidyverse.org/#usage
#   - https://ggplot2.tidyverse.org/#cheatsheet 
#   - https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf
births %>%   ggplot(aes(x = smoke, y = weight)) +
  geom_boxplot() +
  labs(x="Mother’s smoking status", y="Weight (in pounds)")
```

### (d) Construct a plot that shows the relationship between birth weight (`weight`) and gestational age (`weeks`); make sure to specify meaningful axis labels where appropriate.  

```{r, message=FALSE, fig.width=3, fig.height=4, fig.align='center'}
# To figure out how to do this google "ggplot2 scatter plot", or check out 
# - https://ggplot2.tidyverse.org/#usage
#   - https://ggplot2.tidyverse.org/#cheatsheet 
#   - https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf
births %>%   ggplot(aes(x=weeks, y=weight)) +
  geom_point() + labs(x="Gestational Age (in weeks)", y="Weight (in pounds)")
```

\newpage

# Additional Recommended Study Material

Did you finish quickly?  Do you still have an unused course study time allocation? Would you like to cover this material a little bit more?  

## ggplot2

- [Official Cheatsheet](https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf)
  - [Finding Answers](https://ggplot2.tidyverse.org/#getting-help)
- [Learning Resources](https://ggplot2.tidyverse.org/#learning-ggplot2)
  - [Official Usage](https://ggplot2.tidyverse.org/#usage)
  - [R4DS Textbook](https://r4ds.had.co.nz/data-visualisation.html)
  - [DoSS Toolkit](https://dosstoolkit.com/#to-ggplot-or-not-to-ggplot)

## Markdown

Markdown supports efficiency and productivity, and it's needed for our class.

  - [RStudio Markdown Cheatsheet](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf)  
    - [R4DS Introduction](https://r4ds.had.co.nz/r-markdown.html)
    - [RStudio Introduction](https://rmarkdown.rstudio.com/)
  - [Markdown Tutorial](https://www.markdowntutorial.com/)
  
## For Reference Only: ***NOT a Reading Recommendation***
- [knitr Documentation](https://yihui.org/knitr/) 
- [.Rmd Documentation](https://bookdown.org/yihui/rmarkdown/)
  